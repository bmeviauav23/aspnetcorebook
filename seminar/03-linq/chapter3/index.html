
<!DOCTYPE html>

<html class="no-js" lang="hu">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tóth Tibor, Simon Gábor, Albert István, Szabó Gábor" name="author"/>
<link href="https://bmeviauav23.github.io/aspnetcorebook/seminar/03-linq/chapter3/" rel="canonical"/>
<link href="../../02-csharp2/chapter2/" rel="prev"/>
<link href="../../04-csharp4/chapter4/" rel="next"/>
<link href="../../../favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.9" name="generator"/>
<title>LINQ - BMEVIAUAV23 - Szoftverfejlesztés .NET platformra</title>
<link href="../../../assets/stylesheets/main.4af4bdda.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/timeago.css" rel="stylesheet"/>
<link href="../../../extra-material-theme.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/extra-style.jg7ua9ga.min.css" rel="stylesheet"/> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="red" data-md-color-primary="aut" data-md-color-scheme="aut" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#linq">
          Kihagyás
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Élőfej" class="md-header__inner md-grid">
<a aria-label="BMEVIAUAV23 - Szoftverfejlesztés .NET platformra" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="BMEVIAUAV23 - Szoftverfejlesztés .NET platformra">
<img alt="logo" src="../../../logo-bme-aut.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BMEVIAUAV23 - Szoftverfejlesztés .NET platformra
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              LINQ
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Váltás sötét témára" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="aut" data-md-color-scheme="aut" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Váltás sötét témára">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"></path></svg>
</label>
<input aria-label="Váltás világos témára" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="red" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Váltás világos témára">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Keresés" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Keresés" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Keresés" class="md-search__options">
<button aria-label="Törlés" class="md-search__icon md-icon" tabindex="-1" title="Törlés" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Keresés inicializálása
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/bmeviauav23/aspnetcorebook" title="Főoldalra ugrás">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    bmeviauav23/aspnetcorebook
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Lapok" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
          
  
  Tudnivalók

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../01-csharp1/chapter1/">
          
  
  Laborok

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../homework/">
          
  
  Házi feladat

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../information/afterword/">
        
  
    
  
  Zárszó

      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigáció" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BMEVIAUAV23 - Szoftverfejlesztés .NET platformra" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="BMEVIAUAV23 - Szoftverfejlesztés .NET platformra">
<img alt="logo" src="../../../logo-bme-aut.png"/>
</a>
    BMEVIAUAV23 - Szoftverfejlesztés .NET platformra
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/bmeviauav23/aspnetcorebook" title="Főoldalra ugrás">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    bmeviauav23/aspnetcorebook
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Tudnivalók
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Tudnivalók
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Szoftverfejlesztés .NET platformra
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../information/preface/">
<span class="md-ellipsis">
    Tudnivalók
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../information/contributing/">
<span class="md-ellipsis">
    Hozzájárulás az anyaghoz
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Laborok
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Laborok
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../01-csharp1/chapter1/">
<span class="md-ellipsis">
    C# alapok, szintaxis
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02-csharp2/chapter2/">
<span class="md-ellipsis">
    C# alapok II.
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    LINQ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    LINQ
    
  </span>
</a>
<nav aria-label="Tartalomjegyzék" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#elokeszites">
<span class="md-ellipsis">
      Előkészítés
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lambda-kifejezesek-delegatok">
<span class="md-ellipsis">
      Lambda kifejezések, delegátok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#func-action">
<span class="md-ellipsis">
      Func&lt;&gt;, Action&lt;&gt;
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ienumerablet-bovito-metodusok">
<span class="md-ellipsis">
      IEnumerable\&lt;T&gt; bővítő metódusok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gyakori-lekerdezo-muveletek-yield-return">
<span class="md-ellipsis">
      Gyakori lekérdező műveletek, yield return
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#anonim-tipusok">
<span class="md-ellipsis">
      Anonim típusok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#linq-szintaxisok">
<span class="md-ellipsis">
      LINQ szintaxisok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kitekinto-expression-linq-providerek">
<span class="md-ellipsis">
      Kitekintő: Expression\&lt;&gt;, LINQ providerek
    </span>
</a>
<nav aria-label="Kitekintő: Expression\&lt;&gt;, LINQ providerek" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#a-linq-providerek-altalanos-mukodese">
<span class="md-ellipsis">
      A LINQ providerek általános működése
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../04-csharp4/chapter4/">
<span class="md-ellipsis">
    C# alapok IV.
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../05-aspnetcore1/chapter5/">
<span class="md-ellipsis">
    ASP.NET Core alapszolgáltatások
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../06-efcore/chapter6/">
<span class="md-ellipsis">
    Entity Framework Core I-II.
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../07-restapi/chapter7/">
<span class="md-ellipsis">
    ASP.NET Core webszolgáltatások I.-II.
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../08-client/chapter8/">
<span class="md-ellipsis">
    ASP.NET Core webszolgáltatások III.
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../10-test/chapter10/">
<span class="md-ellipsis">
    Automatizált tesztelés
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Házi feladat
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Házi feladat
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../homework/">
<span class="md-ellipsis">
    Házi feladat tudnivalók
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../homework/example-spec/">
<span class="md-ellipsis">
    Példa kisHF specifikáció
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../homework/hw-points/">
<span class="md-ellipsis">
    NagyHF pontrendszer
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../information/afterword/">
<span class="md-ellipsis">
    Zárszó
    
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Tartalomjegyzék" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#elokeszites">
<span class="md-ellipsis">
      Előkészítés
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#lambda-kifejezesek-delegatok">
<span class="md-ellipsis">
      Lambda kifejezések, delegátok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#func-action">
<span class="md-ellipsis">
      Func&lt;&gt;, Action&lt;&gt;
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ienumerablet-bovito-metodusok">
<span class="md-ellipsis">
      IEnumerable\&lt;T&gt; bővítő metódusok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gyakori-lekerdezo-muveletek-yield-return">
<span class="md-ellipsis">
      Gyakori lekérdező műveletek, yield return
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#anonim-tipusok">
<span class="md-ellipsis">
      Anonim típusok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#linq-szintaxisok">
<span class="md-ellipsis">
      LINQ szintaxisok
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kitekinto-expression-linq-providerek">
<span class="md-ellipsis">
      Kitekintő: Expression\&lt;&gt;, LINQ providerek
    </span>
</a>
<nav aria-label="Kitekintő: Expression\&lt;&gt;, LINQ providerek" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#a-linq-providerek-altalanos-mukodese">
<span class="md-ellipsis">
      A LINQ providerek általános működése
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/bmeviauav23/aspnetcorebook/edit/master/docs/seminar/03-linq/chapter3.md" title="Oldal szerkesztése">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<h1 id="linq">LINQ<a class="headerlink" href="#linq" title="Permanent link">¶</a></h1>
<h2 id="elokeszites">Előkészítés<a class="headerlink" href="#elokeszites" title="Permanent link">¶</a></h2>
<p>A gyakorlat kezdetén klónozzuk le a <a href="https://github.com/bmeviauav23/Linq-lab">kiinduló projektet</a> az alábbi paranccsal:</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/bmeviauav23/Linq-lab.git
</code></pre></div>
<p>Nyissuk meg Visual Studio-ban a <em>HelloLinq.sln</em> solution fájlt.</p>
<p>Megnyitás után tekintsük át a kiinduló projektben levő fájlokat:</p>
<ul>
<li><strong>Program.cs</strong>: a legfelső szintű kódot tartalmazó osztály. Található benne egy <code>Dogs</code> változó, ami a <code>Dog</code> osztály statikus <code>Repository</code> tulajdonságába hív át.</li>
<li><strong>Dog.cs</strong>: a korábbi gyakorlatokon használt adatmodell (apróbb módosításokkal).<ul>
<li>Bekerült egy <code>Siblings</code> tulajdonság, a <code>ToString</code> pedig kiírja a kutyához tartozó testvérek számát is (ehhez a <code>TrimPad</code> bővítő metódust használja).</li>
<li>A statikus <code>Repository</code> tulajdonság mögött egy lustán inicializált <code>Lazy&lt;T&gt; RepositoryHolder</code> található, ami egy megfelelően formázott bemeneti CSV fájlból elkészíti számunkra az adatmodellt, amivel a későbbiekben dolgozunk. Ennek implementációját elég a gyakorlat végén megnézni. Az <code>Import</code> és <code>Export</code> függvények a kutyák sorosítását végzik el mindkét irányban.</li>
</ul>
</li>
<li><strong>Extensions/StringExtensions.cs</strong>: ez az osztály tartalmaz egy segédmetódust a formázott kiíráshoz. A <code>Dog</code> <code>ToString</code> metódusa használja fel. A bővítő metódusos részben lesz jelentősége.</li>
<li><strong>dogs.csv</strong>: egy pontosvesszővel tagolt adathalmaz, amelyben 100 darab előre felvett kutya adata található. Innen puskázhatunk, ha ellenőrizni akarjuk, hogy helyesek-e a programunk eredményei.</li>
</ul>
<p>A kiinduló projektben a globális implicit névtérhivatkozások ki vannak kapcsolva. A <strong>csproj</strong> fájlban megnézhetjük (menu:jobb klikk a projekten[Edit Project File]):</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;ImplicitUsings&gt;</span>disable<span class="nt">&lt;/ImplicitUsings&gt;</span>
</code></pre></div>
<h2 id="lambda-kifejezesek-delegatok">Lambda kifejezések, delegátok<a class="headerlink" href="#lambda-kifejezesek-delegatok" title="Permanent link">¶</a></h2>
<p>Gyakori feladat, hogy objektumok kollekciójával kell dolgoznunk.
Képesek vagyunk olyan jellegű segédfüggvényeket készíteni, amik például egy kollekcióban kikeresik az összes olyan elemet, amely egy megadott feltételnek eleget tesz.</p>
<p>A <code>Program.cs</code> fájlban látható ennek a kezdeti naiv változata, szemrevételezzük:</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ListDogsByNamePrefix</span><span class="p">(</span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dogs</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">prefix</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">dog</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">dogs</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dog</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">result</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Próbáljuk ki!</p>
<p>A kód működik, viszont nem újrahasznosítható.
Ha bármi más alapján szeretnénk keresni a kutyák között (pl. a neve tartalmaz-e egy adott szövegrészt), mindig egy új segédfüggvényt kell készítenünk, ami rontja a kód újrahasznosíthatóságát.</p>
<p>Oldjuk meg úgy, hogy az általános problémát is megoldjuk!
Ehhez az szükséges, hogy a kollekciónk egyes elemein kiértékelhessünk egy, a hívó által megadott predikátumot.
Készítsük el az általánosabb változatot, ehhez felhasználhatjuk a <code>ListDogsByNamePrefix</code> kódját.</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ListDogsByPredicate</span><span class="p">(</span>
<span class="hll"><span class="w">    </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dogs</span><span class="p">,</span><span class="w"> </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">predicate</span><span class="p">)</span>
</span><span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">dog</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">dogs</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">predicate</span><span class="p">(</span><span class="n">dog</span><span class="p">))</span>
</span><span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">result</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>A legfelső szintű kódban így hívhatjuk meg (felhasználhatjuk az eredeti ciklust):</p>
<div class="highlight"><pre><span></span><code><span class="k">foreach</span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">dog</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">ListDogsByPredicate</span><span class="p">(</span><span class="n">Dogs</span><span class="p">,</span><span class="w"> </span><span class="k">delegate</span><span class="w"> </span><span class="p">(</span><span class="n">Dog</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">searchText</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">);</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Egy egy bemenő paraméterű és egy logikai (<code>bool</code>) értéket visszadó függvényt definiálunk helyben (<em>inline</em>) és ezt (illetve a referenciáját) adjuk át.
Használjunk inkább lambda kifejezést, az jóval rövidebben leírható - egyelőre csak nézzük meg, de ne integráljuk a kódba:</p>
<div class="highlight"><pre><span></span><code><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">searchText</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">);</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Lambda kifejezések szintaktikája</p>
<p>Lambda kifejezéssel az egyetlen kifejezésből álló függvényeket adhatjuk meg nagyon kompakt módon. A <code>=&gt;</code>-tól balra elnevezzük a bemenő paramétereket, jobbra pedig felhasznál(hat)juk. A <code>return</code>, <code>{}</code> és egyéb sallangokat elhagyhatjuk.</p>
</div>
<p>Vessük össze, hogy az első esetben explicit megadtuk, hogy a bemenő paraméterünk <code>Dog</code>, most viszont nem.
Ezt a fordító statikus kódanalízis alapján el tudja dönteni: a <code>d</code> változónk nem lehet más, csak <code>Dog</code> (statikus) típusú, ezért csak így használhatjuk, viszont nem kell kiírnunk a típust.</p>
<p>A lambda kifejezések egy lehetséges módja a delegátok leírásának. A delegát kódot reprezentál, viszont a kódot kezelhetjük adatként is.</p>
<p>Próbáljuk meg a delegátunkat kivenni egy implicit típusú változóba a ciklus előtt:</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="c1">// fordítási hiba!</span>
</span><span class="hll"><span class="kt">var</span><span class="w"> </span><span class="n">predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span class="hll"><span class="w">    </span><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">searchText</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">);</span>
</span><span class="hll"><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">dog</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">ListDogsByPredicate</span><span class="p">(</span><span class="n">Dogs</span><span class="p">,</span><span class="w"> </span><span class="n">predicate</span><span class="p">))</span>
</span><span class="p">{</span>
<span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Fordítási hibát kapunk, lambda kifejezés típusa nem lehet implicit eldönthető az inicializációs sorban: sem a bemenő paraméter pontos típusát nem tudjuk (<code>Dog</code>? <code>Puppy</code>?), sem a visszatérési értéket (<code>bool</code>? <code>object</code>? <code>void</code>?). Tehát explicit meg kell adnunk a típust:</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">predicate</span><span class="w"> </span><span class="o">=</span>
</span><span class="w">    </span><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">searchText</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">);</span>
</code></pre></div>
<p>Ezután fordul és fut is az alkalmazásunk.</p>
<div class="admonition tip">
<p class="admonition-title">Predicate beépített deleagate típus</p>
<p>Ehhez tudnunk kellett, hogy a <code>Predicate&lt;T&gt;</code> megfelelő szignatúrájú. Mutassuk meg ezen típus dokumentációját vagy tegyük a kurzort a típusra és nyomjunk <span class="keys"><kbd class="key-f12">F12</kbd></span>-t.</p>
</div>
<h2 id="func-action"><code>Func&lt;&gt;</code>, <code>Action&lt;&gt;</code><a class="headerlink" href="#func-action" title="Permanent link">¶</a></h2>
<p>Ismerkedjünk meg a <code>Func</code> és <code>Action</code> általános delegáttípusokkal.
Ezzel a két generikus típussal (pontosabban a változataikkal) gyakorlatilag az összes gyakorlatban előforduló függvényszignatúrát le lehet fedni.
Például a fenti szűrőlogikát is átírhatnánk erre:</p>
<div class="highlight"><pre><span></span><code><span class="n">Func</span><span class="o">&lt;</span><span class="n">Dog</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dogFunc</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">searchText</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">);</span>
</code></pre></div>
<p>A <code>dogFunc</code> és a <code>predicate</code> kompatibilisnek tűnhetnek (elvégre a jobboldaluk ugyanaz), ám ha lecserélnénk pl. a <code>ListDogsByPredicate(Dogs, predicate)</code> hívásban a <code>predicate</code>-et <code>dogFunc</code>-ra, a kód nem fordulna, ugyanis a két delegáttípus nem kompatibilis.</p>
<p>Az <code>Action&lt;&gt;</code> hasonló elven működik, visszatérési érték nélküli függvényekre.</p>
<div class="admonition note">
<p class="admonition-title">Egyéb delegate típusok</p>
<p>Ha minden esetre jók, miért vannak használatban <code>Action&lt;&gt;</code> és <code>Func&lt;&gt;</code>-on kívül más delegáttípusok?
Egyrészt történelmi okok miatt. Később jelentek meg, mint a specifikusak, például a <code>Predicate&lt;T&gt;</code>. Másrészt a specifikusabbak a nevükkel kifejezőbbek lehetnek.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Tiszta függvények</p>
<p>A fenti predikátumváltozataink mind nem tiszta függvények (pure function), ugyanis olyan adattól is függ a visszatérési értéke, ami nem szerepel a paraméterlistáján - ez esetünkben a <code>searchText</code> változó.
A kódunk azért működik, mert a delegát megadásakor a <code>searchText</code> aktuális értékét <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/lambda-expressions#capture-of-outer-variables-and-variable-scope-in-lambda-expressions">elkapjuk (capture)</a>, belerakjuk a függvénylogikába.</p>
</div>
<p>Próbáljuk a <code>dogFunc</code>-ot <code>var</code>-ként deklarálni.</p>
<div class="highlight"><pre><span></span><code><span class="c1">//Fordítási hiba!</span>
<span class="kt">var</span><span class="w"> </span><span class="n">dogFunc</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">searchText</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">);</span>
</code></pre></div>
<p>A fordító nem tudja meghatározni a <code>d</code> paraméter típusát, ezért kapjuk a fordítási hibát. Adjuk meg explicit a paraméter típusát.</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">dogFunc</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="p">(</span><span class="n">Dog</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="n">searchText</span><span class="p">,</span><span class="w"> </span><span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">);</span>
</code></pre></div>
<p>Debugger-rel ellenőrizhetjük, hogy a <code>dogFunc</code> valódi típusa <code>Func&lt;Dog, bool&gt;</code> lesz.</p>
<h2 id="ienumerablet-bovito-metodusok">IEnumerable\&lt;T&gt; bővítő metódusok<a class="headerlink" href="#ienumerablet-bovito-metodusok" title="Permanent link">¶</a></h2>
<p>Vigyük tovább az általánosítást.
Írjunk olyan logikákat, mely nem csak kutyák listájára, hanem bármilyen felsorolható (enumerálható) kollekcióra működik.
Írjunk <code>IEnumerable&lt;T&gt;</code> típuson működő segédfüggvényeket.</p>
<p>Hozzunk létre egy <code>EnumerableExtensions</code> (I betű nélkül, az ugyanis interfészre utal) nevű fájlt az <code>Extensions</code> mappában!
Elsőként valósítsuk meg az összegző logikát.</p>
<div class="highlight"><pre><span></span><code><span class="k">namespace</span><span class="w"> </span><span class="nn">HelloLinq.Extensions.Enumerable</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">EnumerableExtensions</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Sum</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w">  </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w">  </span><span class="n">sumSelector</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">source</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">sumSelector</span><span class="p">(</span><span class="n">elem</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Hívjuk meg a legfelső szintű kódból.</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="k">using</span><span class="w"> </span><span class="nn">HelloLinq.Extensions.Enumerable</span><span class="p">;</span>
</span>
<span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Dogs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dog</span><span class="p">.</span><span class="n">Repository</span><span class="p">.</span><span class="n">Values</span><span class="p">;</span>
<span class="hll"><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">dog</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Dogs</span><span class="p">)</span>
</span><span class="hll"><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">dog</span><span class="p">);</span>
</span><span class="hll"><span class="p">}</span>
</span><span class="hll">
</span><span class="hll"><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span>
</span><span class="hll"><span class="w">    </span><span class="s">"Életkorok összege: "</span><span class="w"> </span>
</span><span class="hll"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s">$"{EnumerableExtensions.Sum(Dogs, d =&gt; d.Age ?? 0)}"</span><span class="p">);</span>
</span>
<span class="kt">string</span><span class="w"> </span><span class="n">searchText</span><span class="p">;</span>
</code></pre></div>
<p>A segédfüggvények hátránya, hogy ismernünk kell a segédosztály nevét.
Továbbá jobb lenne, ha a kollekción közvetlenül hívhatnánk az összegző függvényt.
Erre megoldás a bővítő metódus.</p>
<p>A bővítő metódusok:</p>
<ul>
<li>statikus osztályban definiálhatók</li>
<li>statikus függvények</li>
<li>első paramétere előtt <code>this</code> jelöli, hogy melyik típust bővítik</li>
</ul>
<p>Az első paraméter elé tegyük be a <code>this</code> jelölőt.</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Sum</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="w">    </span><span class="k">this</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w">  </span><span class="n">source</span><span class="p">,</span>
</span><span class="w">    </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w">  </span><span class="n">sumSelector</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>Most már használhatjuk azt a szintaxist, mintha a kollekciónak eleve lenne összegző függvénye:</p>
<div class="highlight"><pre><span></span><code><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$"Életkorok összege: {Dogs.Sum(d =&gt; d.Age ?? 0)}"</span><span class="p">);</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">OO egységbezárási elv</p>
<p>A bővítő metódusok semmilyen módon nem bontják meg a típusok egységbezárási képességeit. A függvények implementációi a bővítendő típusok kívülről is elérhető függvényeit, propertyjeit használhatják, privát adattagokhoz, függvényekhez nem férnek hozzá.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Osztály nevének feloldása</p>
<p>A bővítő metódusok alkalmazásakor nagyon fontos, hogy bár a bővítő metódus osztályának nevét nem írjuk ki, az osztály nevének feloldhatónak kell lennie, azaz az osztály névterét <code>using</code> direktívával be kell hivatkoznunk.
Egy próba erejéig kommentezzük ki a <code>using HelloLinq.Extensions.Enumerable;</code> sort és ellenőrizzük, hogy nem fordul a kódunk, a bővítő metódus nevét a fordító nem tudja feloldani.</p>
</div>
<p>Gyakorlásképpen írhatunk további gyakori adatfeldolgozási műveletekre függvényeket, mint amilyen az átlagszámítás, min-max keresés.</p>
<details class="success">
<summary>Megoldás</summary>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">EnumerableExtensions</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">Average</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sumSelector</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// Az osztás művelet miatt double</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">source</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">elements</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">sumSelector</span><span class="p">(</span><span class="n">elem</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">elements</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Min</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">valueSelector</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">.</span><span class="n">MaxValue</span><span class="p">;</span>
<span class="w">        </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">source</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">currentValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valueSelector</span><span class="p">(</span><span class="n">elem</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentValue</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentValue</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">value</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Max</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">valueSelector</span><span class="p">)</span>
<span class="w">        </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">source</span><span class="p">.</span><span class="n">Min</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">valueSelector</span><span class="p">(</span><span class="n">e</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>Próbáljuk ki az új függvényeket. Mivel a <code>Dogs</code> típusa <code>IEnumerable&lt;Dog&gt;</code>, így a bővítő metódusok bővítendő típusa illeszkedik rá.</p>
<div class="highlight"><pre><span></span><code><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$"Átlagos életkor: {Dogs.Average(d =&gt; d.Age ?? 0)}"</span><span class="p">);</span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span>
<span class="w">    </span><span class="s">$"Minimum-maximum életkor: "</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="s">$"{Dogs.Min(d =&gt; d.Age ?? 0)} | {Dogs.Max(d =&gt; d.Age ?? 0)}"</span><span class="p">);</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">StringExtensions.cs</p>
<p>A <code>StringExtensions</code> osztályban egy lambdaként megvalósított bővítő metódust láthatunk, ami egy szöveget adott hosszra (szélességre) egészít ki szóközökkel. A függvényt a <code>Dog</code> <code>ToString</code> metódusa használja fel.</p>
</div>
<h2 id="gyakori-lekerdezo-muveletek-yield-return">Gyakori lekérdező műveletek, yield return<a class="headerlink" href="#gyakori-lekerdezo-muveletek-yield-return" title="Permanent link">¶</a></h2>
<p>Gyakran előfordul, hogy egy listát szűrni vagy projektálni szeretnénk. Írjunk saját generátort ezekhez a műveletekhez is az <code>EnumerableExtensions</code>-be:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Where</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="k">this</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w">  </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Predicate</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w">  </span><span class="n">predicate</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">source</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">predicate</span><span class="p">(</span><span class="n">elem</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">yield</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">elem</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">TValue</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Select</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">TValue</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">    </span><span class="k">this</span><span class="w"> </span><span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w">  </span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">Func</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">TValue</span><span class="o">&gt;</span><span class="w"> </span><span class="n">selector</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">source</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">yield</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nf">selector</span><span class="p">(</span><span class="n">elem</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Próbáljuk ki a legfelső szintű kód elején, válasszuk ki a 2010 előtt született kutyák nevét és korát egy stringbe:</p>
<div class="highlight"><pre><span></span><code><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Dogs</span>
<span class="w">    </span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">DateOfBirth</span><span class="o">?.</span><span class="n">Year</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2010</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s">$"{d.Name} ({d.Age})"</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">A yield return haszna</p>
<p>A <code>yield return</code> egy hasznos eszköz, ha IEnumerable-t kell produkálnunk visszatérési értékként. Segítségével mindig csak akkor állítjuk elő a következő elemet, amikor a hívó kéri. A működését debuggerrel is figyeljük meg: tegyünk breakpointot a két <code>yield return</code> sorra, majd <span class="keys"><kbd class="key-f10">F10</kbd></span>-zel kövessük végig, ahogy a <code>foreach</code> elkéri a <code>Select</code>-től a következő elemet, ami emiatt elkéri a <code>Where</code>-től, majd újraindul a ciklus. A hívások állapotgépként működnek, a következő meghíváskor onnan folytatódnak, ahonnan az előző <code>yield return</code>-nél kiléptünk.</p>
</div>
<p>Nem nagy meglepetés, hogy az általunk megírt <code>Sum</code>, <code>Average</code> (melyek egyedi visszatérésűek), <code>Select</code> és <code>Where</code> (amik szekvenciális visszatérésűek, generátorok) metódusok mind a .NET keretrendszer részét képezik (a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable"><code>System.Linq.Enumerable</code></a> statikus osztályban definiált bővítő metódusok). A <strong>LINQ</strong> — **L**anguage **IN**tegrated **Q**uery — ezeket a műveleteket teszi lehetővé <code>IEnumerable</code> interfészt megvalósító objektumokon. A LINQ függvények bővítő metódusként lettek hozzáadva meglevő funkcionalitáshoz (kollekciókhoz, lekérdezésekhez), sőt, külső library-k is adnak saját LINQ bővítő metódusokat.</p>
<p>Cseréljük le a <code>Program.cs</code>-ben a <code>using HelloLinq.Extensions.Enumerable</code> hivatkozást <code>using System.Linq</code>-re: az általunk megírt kód továbbra is ugyanazt az eredményt produkálja! Nézzük meg, hogy hol vannak definiálva ezek a függvények a keretrendszeren belül: a kurzort tegyük a kódban oda, ahol valamelyik korábban megírt függvényünket hívnánk, majd nyomjunk <span class="keys"><kbd class="key-f12">F12</kbd></span>-t. Próbáljuk ki, hogy továbbra is az elvárt módon működik-e a programunk.</p>
<div class="admonition tip">
<p class="admonition-title">Implicit usings</p>
<p>A névtércsere helyett bekapcsolhatjuk a globális implicit névtér funkciót, mert a <code>System.Linq</code> névtér is egy implicit hivatkozott névtér. Ehhez a projektfájlban az <code>&lt;ImplicitUsings&gt;disable&lt;/ImplicitUsings&gt;</code> beállítást írjuk át <code>enable</code>-re, majd a <code>using HelloLinq</code> -en kívül minden névtérhivatkozást töröljünk a <code>Program.cs</code>-ből.</p>
</div>
<h2 id="anonim-tipusok">Anonim típusok<a class="headerlink" href="#anonim-tipusok" title="Permanent link">¶</a></h2>
<p>Lekérdezéseknél gyakran használatosak az anonim típusok, amelyeket jellemzően lekérdezések eredményének ideiglenes, típusos tárolására használunk.
Az anonim típusokkal lehetőségünk van <em>inline</em> definiálni olyan osztályokat, amelyek jellemzően csak dobozolásra és adattovábbításra használtak.
Vegyük az alábbi példákat a legfelső szintű kód elején:</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">dolog1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Alma"</span><span class="p">,</span><span class="w"> </span><span class="n">Weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">};</span>
<span class="kt">var</span><span class="w"> </span><span class="n">dolog2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Körte"</span><span class="p">,</span><span class="w"> </span><span class="n">Weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">90</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
<p>Korábban már említettük a <code>var</code> kulcsszót, amellyel implicit típusú, lokális változók definiálhatók.
Az értékadás jobb oldalán definiálunk egy-egy anonim típust, amelynek felveszünk néhány tulajdonságot.
A tulajdonságok mind típusosak maradnak, a típusrendszerünk továbbra is sértetlen.
Az implicit statikus típusosság nem csak a <code>var</code> kulcsszóban jelenik meg tehát, hanem az egyes tulajdonságok típusában is.</p>
<p>Az anonim típusok:</p>
<ul>
<li>csak referencia típusúak lehetnek (objektumok, nem pedig struktúrák),</li>
<li>csak publikusan látható, csak olvasható tulajdonságokat tartalmazhatnak,</li>
<li>eseményeket és metódusokat nem tartalmazhatnak (delegate példányokat tulajdonságban viszont igen),</li>
<li>szerelvényen belül láthatók (<code>internal</code>) és nem származhat belőlük másik típus (<code>sealed</code>)</li>
<li>típusnevét nem ismerjük, így hivatkozni sem tudunk rá, csak a <code>var</code>-t tudjuk használni</li>
<li>nem használhatók ott, ahol a <code>var</code> típus se használható, többek között nem adhatjuk át függvénynek és nem lehet visszatérési érték sem</li>
</ul>
<p>Ha az egeret a <code>var</code> kulcsszavak vagy egyes tulajdonságnevek fölé visszük, láthatjuk, hogy valóban fordítási idejű típusokról van szó.</p>
<div class="admonition tip">
<p class="admonition-title">IntelliSense</p>
<p>Figyeljük meg, hogy az <strong>IntelliSense</strong> is működik ezekre a típusokra, felkínálja a típus property-jeit.</p>
</div>
<p>A fordító újra is hasznosítja az egyes típusokat:</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">dolgok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Gyümölcsök"</span><span class="p">,</span><span class="w"> </span><span class="n">Contents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">dolog1</span><span class="p">,</span><span class="w"> </span><span class="n">dolog2</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
<p>A <code>Contents</code> tulajdonság típusa a fenti anonim objektumaink tömbje, ezért nem is adhatnánk meg másképpen (nem tudjuk a nevét, amivel hivatkozhatunk rá).
A fordító most panaszkodik, ugyanis a két dolog típusa nem implicit következtethető.
Ha felvesszük a <code>Size</code> tulajdonságot a <code>dolog2</code> definíciójába, máris fordul.</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">dolog2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Körte"</span><span class="p">,</span><span class="w"> </span><span class="n">Weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">};</span>
</code></pre></div>
<p>Ha végeztünk az anonim típusokkal való ismerkedéssel, az ezekkel kapcsolatos kódsorokat kikommentezhetjük.</p>
<h2 id="linq-szintaxisok">LINQ szintaxisok<a class="headerlink" href="#linq-szintaxisok" title="Permanent link">¶</a></h2>
<p>Az előző részben ismertetett jellegű lekérdezések nagyban hasonlítanak azokhoz, amiket adatbázis-lekérdezésekben alkalmazunk.
A különbség itt az, hogy imperatív szintaxist használunk, szemben pl. az SQL-lel, ami deklaratívat.
Ezért is van jelen a C# nyelvben az ún. <em>query syntax</em>, amely jóval hasonlatosabb az SQL szintaxisához, így az adatbázisokban jártas fejlesztők is könnyebben írhatnak lekérdezéseket.
Ugyanakkor nem minden lekérdezést tudunk query syntax-szal leírni.</p>
<div class="admonition note">
<p class="admonition-title">Miért nem lehet mindent megírni query syntaxban?</p>
<p>Ennek oka, hogy az operátorok bevezetése egy nyelvben elég drága - le kell péládul foglalni az operátor nevét, amit utána korlátozottan lehet csak használni másra. Ezért sem csinálták meg minden LINQ függvénynek az operátor párját, csak az SQL-ben gyakrabban használatosabbaknak.</p>
</div>
<p>Az előzőhöz hasonló lekérdezést megírhatunk az alábbi módon query syntax használatával:</p>
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="nn">HelloLinq.Extensions</span><span class="p">;</span>

<span class="c1">//...</span>
<span class="n">IEnumerable</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Dogs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dog</span><span class="p">.</span><span class="n">Repository</span><span class="p">.</span><span class="n">Values</span><span class="p">;</span>

<span class="kt">var</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Dogs</span>
<span class="w">            </span><span class="k">where</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">DateOfBirth</span><span class="o">?.</span><span class="n">Year</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2010</span>
<span class="w">            </span><span class="k">select</span><span class="w"> </span><span class="k">new</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="n">Dog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">,</span>
<span class="w">                </span><span class="n">AverageSiblingAge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">Siblings</span><span class="p">.</span><span class="n">Average</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Age</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="p">};</span>
<span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">query</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span>
<span class="w">        </span><span class="s">$"{meta.Dog.Name} - {meta.AverageSiblingAge}"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>A query szintaxis végül a korábban is használt, ún. *fluent szintaxis*sá fordul. Ennek igazolására nézzük meg <span class="keys"><kbd class="key-f12">F12</kbd></span>-vel, hogy hol vannak definiálva az újonnan megismert operátorok (<code>select</code>, <code>where</code>).
A két szintaxist szokás ötvözni is, jellemzően akkor, ha query szintaxisban írjuk a lekérdezést, és a hiányzó funkcionalitást fluent szintaxissal pótoljuk.</p>
<div class="admonition note">
<p class="admonition-title">Fluent szintaxis</p>
<p>A fluent szintaxist olyan kialakítású API-knál alkalmazhatjuk, ahol a függvények a tartalmazó típust várják (egyik) bemenetként és azonos (vagy leszármazott) típust adnak vissza. A LINQ-nél ez a típus az <code>IEnumerable&lt;&gt;</code>.</p>
</div>
<p>Ezen az órán memóriabeli adatforrásokkal dolgoztunk (konkrétan a <code>Dogs</code> nevű <code>Dictionary&lt;,&gt;</code> típusú változóval), a LINQ operátorok közül a memóriabeli listákon dolgozókat használtuk, melyeket az <code>IEnumerable&lt;&gt;</code> interfészre biggyesztettek rá bővítő metódusként.
Ezt a LINQ API-t teljes nevén *LINQ-to-Objects*nek hívják, de gyakran csak LINQ-ként hivatkozzák.</p>
<h2 id="kitekinto-expression-linq-providerek">Kitekintő: Expression\&lt;&gt;, LINQ providerek<a class="headerlink" href="#kitekinto-expression-linq-providerek" title="Permanent link">¶</a></h2>
<p>Vegyük az alábbi nagyon egyszerű delegate-et és ennek <code>Expression&lt;&gt;</code>-ös párját.</p>
<div class="highlight"><pre><span></span><code><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">Expression</span><span class="o">&lt;</span><span class="n">Func</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>Nézzük meg debuggolás közben a <strong>Watch</strong> ablakban a fenti két változót. Az <code>f</code> egy delegate, lefordított <em>kód*ra mutató referencia, az <code>Expression</code> a jobb oldali kifejezésből épített (fa struktúrájú) *adat</em>.</p>
<p>A fát kóddá fordíthatjuk a <code>Compile</code> metódus segítségével, mely a lefordított függvény referenciáját (delegát példány) adja vissza, amit a függvényhívás szintaxissal hívhatunk meg. Ebből áll össze az alábbi fura kinézetű kifejezés:</p>
<div class="highlight"><pre><span></span><code><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Compile</span><span class="p">()(</span><span class="mi">5</span><span class="p">));</span>
</code></pre></div>
<p>Bár az <code>Expression&lt;&gt;</code> emiatt okosabb választásnak tűnik, ám a LINQ-to-Objects alapinterfészének (ami a lekérdezőfüggvényeket biztosítja) függvényei <code>Func&lt;&gt;</code> / <code>Action&lt;&gt;</code> delegátokat várnak.
Ami nem csoda, hiszen memóriabeli listákat általában sima programkóddal dolgozunk fel, nincs értelme felépíteni kifejezésfát csak azért, hogy utána egyből kóddá fordítsuk.
Emellett más, memóriabeli adatokon dolgozó LINQ technológia is létezik, pl. LINQ-to-XML saját API-val (nem <code>IEnumerable&lt;&gt;</code> alaptípussal).</p>
<p>A nem memóriabeli adatokon, hanem például külső adatbázisból dolgozó LINQ provider-ek viszont <code>IQueryable&lt;&gt;</code>-t valósítanak meg.
Az <code>IQueryable&lt;&gt;</code> az <code>IEnumerable&lt;&gt;</code>-ból származik, így neki is vannak <code>Func&lt;&gt;</code> / <code>Action&lt;&gt;</code>-ös függvényei, de emellett <code>Expression&lt;&gt;</code>-ösek is.
Ez utóbbiak teszik lehetővé, hogy ne csak .NET kódot generáljanak a lambda kifejezésekből, hanem helyette pl. SQL kifejezést - hiszen egy relációs adatbázis adatfeldolgozó nyelve nem .NET, hanem valamilyen SQL dialektus.</p>
<h3 id="a-linq-providerek-altalanos-mukodese">A LINQ providerek általános működése<a class="headerlink" href="#a-linq-providerek-altalanos-mukodese" title="Permanent link">¶</a></h3>
<p>Bemenetük: query függvényeknek (<code>IQueryable&lt;&gt;</code> vagy <code>IEnumerable&lt;&gt;</code> függvényei vagy pl. <code>XDocument</code>) paraméterül adott lambdák (<code>Func&lt;&gt;</code> vagy <code>Expression&lt;&gt;</code>)</p>
<p>Kimenetük: az adatforrásnak megfelelő nyelvű, a query-t végrehajtó kód (.NET kód vagy SQL).</p>
<p>LINQ-to-Objects esetén nincs valódi LINQ provider (a provider az <code>IQueryable.Provider</code>-en keresztül érhető el, de a <code>List&lt;&gt;</code> nem <code>IQueryable</code>!), hiszen nincs feladata: kódot kap bemenetül, ugyanazt kellene kimenetül adnia. A <em>LINQ-to-XML</em> is hasonló elven működik.</p>
<p>Valódi LINQ providert valósít meg például az <em>Entity Framework Core</em>, de ezt a technológiát később tárgyaljuk.</p>
<hr/>
<div class="md-source-file">
<span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
</path>
</svg>
</span>
<span title="2025. március 28. 11:46:02">
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="2025. március 28. 11:46:02"><span class="timeago" datetime="2025-03-28T11:46:02+01:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="2025. március 28. 11:46:02">2025-03-28</span>
</span>
</span>
<span class="md-source-file__fact">
<span class="md-icon" title="Szerzők">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
</path>
</svg>
</span>
<span>Szerzők</span>
<nav><a class="md-author" href="https://github.com/kszicsillag" rel="noopener noreferrer" target="_blank" title="@kszicsillag">
<img alt="@kszicsillag" src="https://avatars.githubusercontent.com/kszicsillag?size=72"/>
</a><a class="md-author" href="https://github.com/tibitoth" rel="noopener noreferrer" target="_blank" title="@tibitoth">
<img alt="@tibitoth" src="https://avatars.githubusercontent.com/tibitoth?size=72"/>
</a></nav>
</span>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Vissza a tetejére
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © BME VIK AUT
    </div>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "search.suggest", "content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}}</script>
<script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
<script src="../../../js/timeago.min.js"></script>
<script src="../../../js/timeago_mkdocs_material.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>